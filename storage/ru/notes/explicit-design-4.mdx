---
title: –ß–∞—Å—Ç—å 4. –ü–æ—Ä—Ç—ã, –∞–¥–∞–ø—Ç–µ—Ä—ã –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞
description: "–í —ç—Ç–æ–π —á–∞—Å—Ç–∏ —Å–µ—Ä–∏–∏ –º—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∏–º –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è: –Ω–∞–ø–∏—à–µ–º —Å—Ç–æ—Ä –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–∏ –∏ —Å–æ–∑–¥–∞–¥–∏–º —Å–µ—Ä–≤–∏—Å –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API."
datetime: 2023-05-23T12:00
slug: /blog/explicit-design-4
cover: /images/content/explicit-design-series/04-short-circuit.png
tags:
  - architecture
  - dev
  - fp
  - oop
  - patterns
  - react
  - testing
  - ts
---

# –ß–∞—Å—Ç—å 4. –ü–æ—Ä—Ç—ã, –∞–¥–∞–ø—Ç–µ—Ä—ã –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

–ü—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å–µ—Ä–∏—é –ø–æ—Å—Ç–æ–≤ –∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –∏ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π. [–í –ø—Ä–æ—à–ª—ã–π —Ä–∞–∑](/blog/explicit-design-3/) –º—ã –Ω–∞–ø–∏—Å–∞–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –∏ –æ–±—Å—É–¥–∏–ª–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ UI —Å —è–¥—Ä–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –í —ç—Ç–æ–º –ø–æ—Å—Ç–µ –º—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∏–º –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞: –Ω–∞–ø–∏—à–µ–º —Å—Ç–æ—Ä –¥–ª—è –¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–∏ –∏ —Å–æ–∑–¥–∞–¥–∏–º —Å–µ—Ä–≤–∏—Å –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API.

## –í—ã—Ö–æ–¥–Ω—ã–µ –ø–æ—Ä—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ï—Å–ª–∏ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Ä–∞–∑ UI ¬´—Å—Ç—É—á–∞–ª—Å—è¬ª –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –≤—Ö–æ–¥–Ω—ã–µ –ø–æ—Ä—Ç—ã, —Ç–æ —Å –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –æ–±—â–∞—Ç—å—Å—è —á–µ—Ä–µ–∑ –≤—ã—Ö–æ–¥–Ω—ã–µ –ø–æ—Ä—Ç—ã: —Ç–∏–ø—ã `FetchRates`, `ReadConverter` –∏ `SaveConverter`.

–í—ã—Ö–æ–¥–Ω—ã–µ –ø–æ—Ä—Ç—ã ‚Äî ¬´—Ä—ã—á–∞–∂–∫–∏¬ª –≤ —è–¥—Ä–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å ¬´–¥—Ä—É–≥–æ–π —Å—Ç–æ—Ä–æ–Ω—ã¬ª. –û–Ω–∏ –æ–ø–∏—Å—ã–≤–∞—é—Ç, –∫–∞–∫–∞—è ¬´—Å–µ—Ä–≤–∏—Å–Ω–∞—è¬ª —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –Ω—É–∂–Ω–∞ —è–¥—Ä—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∫–∞–∫–æ–π-—Ç–æ –∑–∞–¥–∞—á–∏.

–ö–æ–¥ —è–¥—Ä–∞ –æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ —ç—Ç–∏ —Ç–∏–ø—ã –∏ ¬´–æ—Ä–∫–µ—Å—Ç—Ä–∏—Ä—É–µ—Ç¬ª —Ä–∞–±–æ—Ç—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, ¬´–∑–∞–ø—É—Å–∫–∞—è¬ª –Ω—É–∂–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã –≤ –Ω—É–∂–Ω—ã–µ –º–æ–º–µ–Ω—Ç—ã –≤—Ä–µ–º–µ–Ω–∏.

<SideNote>
  –¢–∞–∫ –∫–∞–∫ —è–¥—Ä–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è [–æ–ø–∏—Ä–∞–µ—Ç—Å—è –Ω–∞ –∞–±—Å—Ç—Ä–∞–∫—Ç–Ω—ã–µ
  —Ç–∏–ø—ã](https://en.wikipedia.org/wiki/Inversion_of_control), –æ–Ω–æ –ø–æ–ª—É—á–∞–µ—Ç—Å—è –æ—Ç—Ü–µ–ø–ª–µ–Ω–Ω—ã–º –∏
  –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º –æ—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã. –¢–∞–∫–æ–µ –Ω–∞—Ä–æ—á–∏—Ç–æ —è–≤–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∫–æ–¥–∞ —á–∞—Å—Ç–æ –∏–∑–ª–∏—à–Ω–µ, –Ω–æ –º—ã –ø–∏—à–µ–º
  –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ –∑–∞–≤–µ—Ç–∞–º –∏–∑ –∫–Ω–∏–≥, –ø–æ—ç—Ç–æ–º—É –æ—Å—Ç–∞–≤–∏–º –≤—Å—ë –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞—Å—Ü–µ–ø–ª–µ–Ω–Ω—ã–º.
</SideNote>

## –°–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç—ã —Å API

–ü–µ—Ä–≤—ã–π —Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –Ω–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è, ‚Äî —ç—Ç–æ –º–æ–¥—É–ª—å –¥–ª—è –æ–±—â–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º API. –ú—ã –º–æ–≥–ª–∏ –±—ã –æ–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ —Å–µ—Ä–≤–µ—Ä—É –∫–∞–∫-—Ç–æ —Ç–∞–∫:

```ts
// services/network

export async function get<T>(url: Url): Promise<T> {
  const absolute = new URL(url, config.base);
  const response = await fetch(absolute);
  if (!response.ok) throw new Error("Failed to perform the request.");

  return await response.json();
}
```

–§—É–Ω–∫—Ü–∏—è `get` —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç URL-–∞–¥—Ä–µ—Å API-—ç–Ω–¥–ø–æ–∏–Ω—Ç–∞, –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–æ–¥ –∫–∞–ø–æ—Ç–æ–º –±—Ä–∞—É–∑–µ—Ä–Ω—ã–π `fetch` –∏ –ø–∞—Ä—Å–∏—Ç –∏–∑ JSON –æ—Ç–≤–µ—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∫–∞–∫–∏–µ-—Ç–æ –¥–∞–Ω–Ω—ã–µ.

–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ –∫–æ–¥ —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ [_–æ–±–æ–±—â—ë–Ω–Ω—ã–π_](https://www.typescriptlang.org/docs/handbook/2/generics.html). –û–Ω–∞ –Ω–µ –∑–Ω–∞–µ—Ç, –∫–∞–∫–∏–µ –∏–º–µ–Ω–Ω–æ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–¥—É—Ç —Å —Å–µ—Ä–≤–µ—Ä–∞, –∑–∞ –∏—Å–∫–ª—é—á–µ–Ω–∏–µ–º —Ç–æ–≥–æ, —á—Ç–æ —ç—Ç–æ –±—É–¥–µ—Ç JSON.

–û—Ç–ª–∏—á–∏—Ç–µ–ª—å–Ω–∞—è –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç—å _—Å–µ—Ä–≤–∏—Å–æ–≤_ –∫–∞–∫ —Ä–∞–∑ –≤ —Ç–æ–º, —á—Ç–æ –æ–Ω–∏ –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ –Ω–µ —Å–≤—è–∑–∞–Ω—ã —Å _–ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç—å—é_ –∏ –º–æ–≥—É—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å –ª—é–±—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º. –§—É–Ω–∫—Ü–∏—è –≤—Ä–æ–¥–µ `get` –º–æ–∂–µ—Ç –∫–æ—á–µ–≤–∞—Ç—å –∏–∑ –ø—Ä–æ–µ–∫—Ç–∞ –≤ –ø—Ä–æ–µ–∫—Ç, –Ω–∞—Ö–æ–¥—è—Å—å –≤ –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å –ø–∞–ø–∫–µ `lib` –∏–ª–∏ `shared`.

–°–µ—Ä–≤–∏—Å—ã, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª–æ, —Ä–µ—à–∞—é—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —É—Ç–∏–ª–∏—Ç–∞—Ä–Ω—É—é –∑–∞–¥–∞—á—É: –æ–±–µ—Å–ø–µ—á–∏—Ç—å —Ä–∞–±–æ—Ç—É —Å —Å–µ—Ç—å—é, –∏–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—é, —á—Ç–µ–Ω–∏–µ –∏ –∑–∞–ø–∏—Å—å –∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∏ —Ç.–¥. –í —Å–ª—É—á–∞–µ —Å —Ñ—É–Ω–∫—Ü–∏–µ–π `get` —ç—Ç–æ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å–ª–∏ –æ–ø–∏—Å–∞—Ç—å –µ—ë —Ç–∏–ø:

```ts
type ApiRequest<R> = (url: Url) => Promise<R>;
```

–¢–∏–ø `ApiRequest<T>` –Ω–µ –∑–∞—Ç—Ä–∞–≥–∏–≤–∞–µ—Ç _–≤—ã—Å–æ–∫–æ—É—Ä–æ–≤–Ω–µ–≤—ã—Ö_ –∫–æ–Ω—Ü–µ–ø—Ü–∏–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –û–Ω –≤—ã—Ä–∞–∂–∞–µ—Ç—Å—è —Ç–µ—Ä–º–∏–Ω–∞–º–∏ _–Ω–∏–∑–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è_: ¬´–∑–∞–ø—Ä–æ—Å¬ª, ¬´API¬ª, ¬´URL-–∞–¥—Ä–µ—Å¬ª. –û–Ω –¥–∞–∂–µ –Ω–µ –∑–Ω–∞–µ—Ç, –∫–∞–∫–∏–µ –∏–º–µ–Ω–Ω–æ –¥–∞–Ω–Ω—ã–µ –±—É–¥–µ—Ç –ø–æ–ª—É—á–∞—Ç—å –æ—Ç API, –≤–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –æ–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–∏–ø-–∞—Ä–≥—É–º–µ–Ω—Ç `R`, –∫–æ—Ç–æ—Ä—ã–π –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ [–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è —ç—Ç–æ–π —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ –≤–∞–∂–Ω—ã](https://developer.mozilla.org/ru/docs/Glossary/Abstraction) ‚Äî –≤–∞–∂–µ–Ω –º–µ—Ö–∞–Ω–∏–∑–º, —Å—Ö–µ–º–∞ —Ä–∞–±–æ—Ç—ã –∏ –æ–±—â–µ–Ω–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º.

–ò–∑-–∑–∞ –æ–±–æ–±—â–µ–Ω–∏—è —Å–µ—Ä–≤–∏—Å—ã –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö:

![–°–µ—Ä–≤–∏—Å—ã –Ω–∞–ø—Ä—è–º—É—é –Ω–µ —Å–≤—è–∑–∞–Ω—ã —Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º, –æ–Ω–∏ –º–æ–≥—É—Ç –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ —Ä–∞–∑–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö —Å –ø–æ–º–æ—â—å—é –∞–¥–∞–ø—Ç–µ—Ä–æ–≤](/images/content/explicit-design-series/04-services-and-adapters.png)

–û—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ —Ç–∞–∫–æ–π –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π —Å–µ—Ä–≤–∏—Å –≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –Ω–µ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–∞–∫, –∫–∞–∫ —ç—Ç–æ–≥–æ —Ö–æ—á–µ—Ç —è–¥—Ä–æ –Ω–∞—à–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ß—Ç–æ–±—ã —Ä–∞–∑—Ä–µ—à–∏—Ç—å —ç—Ç–æ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ –º—ã –Ω–∞–ø–∏—à–µ–º –∞–¥–∞–ø—Ç–µ—Ä ‚Äî —Ñ—É–Ω–∫—Ü–∏—é, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å —Ä–∞–±–æ—Ç—É —ç—Ç–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –∫ —Ç–∏–ø—É –≤—ã—Ö–æ–¥–Ω–æ–≥–æ –ø–æ—Ä—Ç–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

## –ê–¥–∞–ø—Ç–µ—Ä –∫ —Å–µ—Ä–≤–∏—Å—É API

–í—Å—é —Ä–∞–±–æ—Ç—É –∞–¥–∞–ø—Ç–µ—Ä–∞ –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ API –º—ã –º–æ–∂–µ–º –ø–æ–¥–µ–ª–∏—Ç—å –Ω–∞ 3 —ç—Ç–∞–ø–∞:

- –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ—Ç API ‚Äî –≤—ã–∑–≤–∞—Ç—å –≤–Ω–µ—à–Ω–∏–π —Å–µ—Ä–≤–∏—Å `get`;
- –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∫ —Ñ–æ—Ä–º–∞—Ç—É –¥–æ–º–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏ ‚Äî –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç API;
- –ø–µ—Ä–µ–¥–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ —è–¥—Ä–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—ã—Ö–æ–¥–Ω–æ–π –ø–æ—Ä—Ç `FetchRates`.

–î–æ–ø—É—Å—Ç–∏–º, –º—ã –∑–Ω–∞–µ–º, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä –æ—Ç–¥–∞—ë—Ç –Ω–∞–º –¥–∞–Ω–Ω—ã–µ –≤ —Ñ–æ—Ä–º–∞—Ç–µ:

```json
{
  "rates": {
    "RPC": {
      "IMC": 0.98,
      "WPU": 1.23,
      "DRG": 2.2,
      "ZKL": 1.07
    },
    "IMC": { "//": "..." },
    "WPU": { "//": "..." },
    "DRG": { "//": "..." },
    "ZKL": { "//": "..." }
  }
}
```

–¢–æ–≥–¥–∞ —Å—É—Ç—å —Ä–∞–±–æ—Ç—ã –∞–¥–∞–ø—Ç–µ—Ä–∞ –º–æ–∂–Ω–æ –≤—ã—Ä–∞–∑–∏—Ç—å, –∫–∞–∫ –Ω–∞–±–æ—Ä –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π:

```
RefreshRates:
  API -> ServerRates
  ServerRates -> ExchangeRates
  ExchangeRates -> Application Core
```

–ù–∞–ø–∏—à–µ–º —Ñ—É–Ω–∫—Ü–∏—é `fetchRates`, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤—ã–≤–∞—Ç—å —Ç–∏–ø `FetchRates`:

```ts
// infrastructure/api

export const fetchRates: FetchRates = async () => {
  // TODO:
  // 1. –í—ã–∑–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å API.
  // 2. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç.
  // 3. –í–µ—Ä–Ω—É—Ç—å –¥–∞–Ω–Ω—ã–µ.
};
```

...–ò —Ç–µ–ø–µ—Ä—å —Ä–µ–∞–ª–∏–∑—É–µ–º –∫–∞–∂–¥—ã–π –∏–∑ —à–∞–≥–æ–≤.

### –î–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

–ù–∞—á–Ω—ë–º —Å –ø—Ä–æ—Å—Ç–æ–≥–æ: —Ä–∞–∑ –º—ã –∑–Ω–∞–µ–º, –≤ –∫–∞–∫–æ–º –≤–∏–¥–µ —Å–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ—Ç–≤–µ—Ç, –º—ã –º–æ–∂–µ–º –Ω–∞–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö.

```ts
// infrastructure/api.serialization

type ServerRates = { rates: Record<BaseCurrencyCode, ExchangeRates> };
const toDomain = (dto: ServerRates): ExchangeRates => dto.rates.RPC;
```

–í —Ñ—É–Ω–∫—Ü–∏–∏ –º—ã –æ–±—Ä–∞—â–∞–µ–º—Å—è –∫–æ –∑–Ω–∞—á–µ–Ω–∏—é –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –ø–æ–ª—è –≤ –æ—Ç–≤–µ—Ç–µ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –µ–≥–æ. –í —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö [–¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è](https://en.wikipedia.org/wiki/Serialization) –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —Å–ª–æ–∂–Ω–µ–µ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ—Ç–≤–µ—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞ –∏ —Ñ–æ—Ä–º–∞—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–∏. (–ù–∞–º –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å –ø–æ–ª—è –∏–ª–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –æ–±–æ–≥–∞—Ç–∏—Ç—å –∏—Ö –¥–∞–Ω–Ω—ã–º–∏ –∏—Ö –¥—Ä—É–≥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.)

–°–º—ã—Å–ª —Ñ—É–Ω–∫—Ü–∏–∏ `toDomain` ‚Äî –≤ –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏–∏ –∑–Ω–∞–Ω–∏–π –æ —Ç–æ–º, –∫–∞–∫ —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç—å –≤ –º–æ–¥–µ–ª—å. –ö–æ–≥–¥–∞ —Ç–∞–∫–æ–π –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä —è–≤–Ω–æ –≤—ã–¥–µ–ª–µ–Ω –≤ –∫–æ–¥–µ, –Ω–∞–º –ø—Ä–æ—â–µ –∏—Å–∫–∞—Ç—å –º–µ—Å—Ç–æ, –∫—É–¥–∞ –Ω—É–∂–Ω–æ –≤–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –µ—Å–ª–∏ —Å—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –º–µ–Ω—è–µ—Ç—Å—è.

–ë–æ–ª–µ–µ —Ç–æ–≥–æ, —Å —è–≤–Ω–æ –≤—ã–¥–µ–ª–µ–Ω–Ω–æ–π –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π –º—ã –º–æ–∂–µ–º –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Ö–µ–º –æ—Ç–≤–µ—Ç–∞ API –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ:

```ts
// infrastructure/api.v1.serialization.ts
type ServerRates = { rates: Record<BaseCurrencyCode, ExchangeRates> };
const toDomain = (dto: ServerRates): ExchangeRates => dto.rates.RPC;

// infrastructure/api.v2.serialization.ts
type ServerRates = { default: [BaseCurrencyCode, ExchangeRates] };
const toDomain = (dto: ServerRates): ExchangeRates =>
  dto.default.find(([key]) => key === "RPC").at(1);
```

<SideNote>
  –û–ø—è—Ç—å –∂–µ, –¥–µ–ª–∞—Ç—å –ª–∏ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—é —è–≤–Ω–æ–π ‚Äî –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–∞–¥–∞—á–∏, —Ä–∞–∑–º–µ—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –∏ —Ç–æ–≥–æ, –Ω–∞—Å–∫–æ–ª—å–∫–æ
  –≤–æ–ª–∞—Ç–∏–ª—å–Ω—ã –¥–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ. –ï—Å–ª–∏ –æ—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è, –≤–µ—Ä–æ—è—Ç–Ω–æ, —ç—Ç–æ –Ω–µ –Ω—É–∂–Ω–æ.
</SideNote>

–û—Ç–≤–µ—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞, –∫–æ—Ç–æ—Ä—ã–π –º—ã –æ–ø–∏—Å—ã–≤–∞–µ–º —Ç–∏–ø–æ–≤ `ServerRates`, ‚Äî —ç—Ç–æ —Ç–∞–∫ –Ω–∞–∑—ã–≤–∞–µ–º—ã–π [_–æ–±—ä–µ–∫—Ç –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö, DTO_](https://en.wikipedia.org/wiki/Data_transfer_object). –ú—ã –Ω–µ –±—É–¥–µ–º –ø–æ–¥—Ä–æ–±–Ω–æ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –Ω–∞ —ç—Ç–æ–º –ø–æ–Ω—è—Ç–∏–∏, –Ω–æ —É –°–∫–æ—Ç—Ç–∞ –í–ª–∞—à–∏–Ω–∞ –≤ –µ–≥–æ –∫–Ω–∏–≥–µ ¬´–î–æ–º–µ–Ω–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º —Å—Ç–∏–ª–µ¬ª –µ—Å—Ç—å [–æ—Ç–¥–µ–ª—å–Ω–∞—è –≥–ª–∞–≤–∞](/blog/domain-modelling-made-functional-3/) –æ –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ —Ä–∞–±–æ—Ç–µ —Å DTO. –†–µ–∫–æ–º–µ–Ω–¥—É—é –ø—Ä–æ—á–∏—Ç–∞—Ç—å.

–ò—Å–ø–æ–ª—å–∑—É—è –¥–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä, –º—ã –º–æ–∂–µ–º –∑–∞–ø–æ–ª–Ω–∏—Ç—å 2-–π —à–∞–≥ —Ñ—É–Ω–∫—Ü–∏–∏ `fetchRates`:

```ts
// infrastructure/api

import { toDomain } from "./api.serialization";

const fetchRates: FetchRates = async () => {
  // TODO:
  // 1. –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ—Ç API.

  // 2. –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∫ –¥–æ–º–µ–Ω—É:
  const data = toDomain(response);

  // 3. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –∫–æ–Ω—Ç—Ä–∞–∫—Ç –Ω–∞ `FetchRates`:
  return data;
};
```

### –í—ã–∑–æ–≤ —Å–µ—Ä–≤–∏—Å–∞

–î–∞–ª–µ–µ –æ–±—Ä–∞—Ç–∏–º—Å—è –∫ –Ω–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ —Å–µ—Ä–≤–∏—Å—É –∏ –ø–æ–ª—É—á–∏–º –¥–∞–Ω–Ω—ã–µ –æ—Ç API:

```ts
// infrastructure/api

import type { FetchRates } from "../../core/ports.output";
import type { ServerRates } from "./api.serialization";
import { toDomain } from "./api.serialization";

import { get } from "~/services/network";

const fetchRates: FetchRates = async () => {
  // 1. –ü–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ—Ç API:
  const response = await get<ServerRates>("/rates");

  const data = toDomain(response);
  return data;
};
```

–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ URL-–∞–¥—Ä–µ—Å —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ –º—ã –¥–µ—Ä–∂–∏–º –ø—Ä—è–º–æ –≤ —ç—Ç–æ–º –º–æ–¥—É–ª–µ, –∞ –Ω–µ –≤ —Å–µ—Ä–≤–∏—Å–µ `network`. –ü—Ä–∏—á–∏–Ω–∞ –≤ —Ç–æ–º, —á—Ç–æ —Å–µ—Ä–≤–∏—Å –¥–æ–ª–∂–µ–Ω –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–º –∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º –æ—Ç –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞.

–ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π URL —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ ‚Äî —ç—Ç–æ —á–∞—Å—Ç—å –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–π —Ñ–∏—á–∏ —Ç–µ–∫—É—â–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞. –ó–Ω–∞–Ω–∏—è –æ —Ç–æ–º, –∫–∞–∫ –ø–æ–ª—É—á–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–∞, –¥–æ–ª–∂–Ω—ã [—Ö—Ä–∞–Ω–∏—Ç—å—Å—è —Ä—è–¥–æ–º](<https://en.wikipedia.org/wiki/Cohesion_(computer_science)>) —Å —Å–∞–º–∏–º –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–æ–º, —á—Ç–æ–±—ã –º—ã –º–æ–≥–ª–∏ –±—ã—Å—Ç—Ä–æ –∏—Å–∫–∞—Ç—å –Ω—É–∂–Ω—ã–µ –º–µ—Å—Ç–∞ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è. –≠—Ç–æ –ø–æ–≤—ã—à–∞–µ—Ç _—Å–≤—è–∑–Ω–æ—Å—Ç—å_ —Ñ–∏—á–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–µ —Ä–∞–∑–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∑–Ω–∞–Ω–∏—è –æ –Ω–µ–π –ø–æ —Ä–∞–∑–Ω—ã–º —á–∞—Å—Ç—è–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

<SideNote>
  –¢–∞–∫–∞—è ¬´—É–ø–∞–∫–æ–≤–∫–∞ –∑–Ω–∞–Ω–∏–π¬ª –ø–æ-–¥—Ä—É–≥–æ–º—É [–Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è _–≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ã–º
  —Å–ª–∞–π—Å–æ–º_](https://herbertograca.com/2019/06/05/reflecting-architecture-and-domain-in-code/). –ú—ã
  –ø–æ–≥–æ–≤–æ—Ä–∏–º –æ–± —ç—Ç–æ–º –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–º –ø–∞—Ç—Ç–µ—Ä–Ω–µ –≤ –æ–¥–Ω–æ–º –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –ø–æ—Å—Ç–æ–≤ üôÉ
</SideNote>

–í —Ü–µ–ª–æ–º, —ç—Ç–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —É–∂–µ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ, —á—Ç–æ–±—ã –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—ã–∑–æ–≤ API —Å —è–¥—Ä–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –û–±—Ä–∞—â–µ–Ω–∏–µ –∫ —ç—Ç–æ–º—É –∞–¥–∞–ø—Ç–µ—Ä—É –∑–∞—Å—Ç–∞–≤–∏—Ç –µ–≥–æ –≤—ã–∑–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å, –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∫ –Ω—É–∂–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É –∏ –≤–µ—Ä–Ω—É—Ç—å –∏—Ö.

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, –º–æ–∫–∏ –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–ß—Ç–æ–±—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–∞–∫–æ–π –∞–¥–∞–ø—Ç–µ—Ä, –Ω–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –º–æ–∫ –¥–ª—è –º–æ–¥—É–ª—è `~/services/network` –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ñ—É–Ω–∫—Ü–∏—è `get` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å –Ω—É–∂–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏.

```ts
// infrastructure/api.test

const spy = vi.fn(() => serverStub);
vi.mock("~/services/network", () => ({ get: spy }));

// ...

it("triggers API call", async () => {
  await fetchRates();
  expect(spy).toHaveBeenCalledOnce();
  expect(spy).toHaveBeenCalledWith("/rates");
});
```

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–æ–∫–∏ –¥–ª—è –ø–æ–¥–º–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π ‚Äî —ç—Ç–æ –≤–ø–æ–ª–Ω–µ –≤–∞–ª–∏–¥–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç –≤ JS –∏ TS –∫–æ–¥–µ. –í —Ä–µ–∞–ª—å–Ω—ã—Ö —Ç–µ—Å—Ç–∞—Ö —Ñ—É–Ω–∫—Ü–∏–π, —Ä–∞–±–æ—Ç–∞—é—â–∏—Ö —Å —Å–∞–π–¥-—ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏, –º—ã —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ –±—É–¥–µ–º –≤–∏–¥–µ—Ç—å –∏–º–µ–Ω–Ω–æ –º–æ–∫–∏. –û–¥–Ω–∞–∫–æ, –µ—Å–ª–∏ –º—ã –ø–∏—à–µ–º –∫–æ–¥ ¬´–ø–æ –∫–Ω–∏–∂–∫–∞–º¬ª –∏ –Ω–∞—à–∞ —Ü–µ–ª—å ‚Äî —Å–¥–µ–ª–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏ —è–≤–Ω—ã–º–∏, –º—ã –º–æ–∂–µ–º –∏—Ö ¬´–∑–∞–ø–µ—á—å¬ª.

### –ß–∞—Å—Ç–∏—á–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏ —è–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

<SideNote>
–î–∏—Å–∫–ª–µ–π–º–µ—Ä: –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –º—ã –±—É–¥–µ–º –ø–∏—Å–∞—Ç—å –¥–∞–ª—å—à–µ, –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π&trade;. –ú—ã –Ω–∞–ø–∏—à–µ–º –µ–≥–æ —Ç–∞–∫–∏–º, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å —Å—É—Ç—å –∏–¥–µ–∏ —Å–ª–∞–±–æ–≥–æ –∑–∞—Ü–µ–ø–ª–µ–Ω–∏—è –∏ —è–≤–Ω–æ–π –ø–µ—Ä–µ–¥–∞—á–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π. –ù–µ–ø–æ—Å—Ä–µ–¥—Å—Ç–≤–µ–Ω–Ω–æ —Ç–∞–∫ –ø–∏—Å–∞—Ç—å –∫–æ–¥ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ, –≤–µ—Ä–æ—è—Ç–Ω–æ, –Ω–µ —Å—Ç–æ–∏—Ç, –µ—Å–ª–∏ —É –≤–∞—Å –Ω–µ—Ç –Ω–∞ —Ç–æ —Å–µ—Ä—å—ë–∑–Ω—ã—Ö –ø—Ä–∏—á–∏–Ω.

–ú—ã –ø–æ–≥–æ–≤–æ—Ä–∏–º –æ —Ç–æ–º, –∫–æ–≥–¥–∞ –ø–∏—Å–∞—Ç—å –∏–º–µ–Ω–Ω–æ —Ç–∞–∫–æ–π –∫–æ–¥ –æ–ø—Ä–∞–≤–¥–∞–Ω–æ, –∞ –∫–æ–≥–¥–∞ ‚Äî –Ω–µ—Ç. –ü–æ–∫–∞ —á—Ç–æ —è –ø–æ–ø—Ä–æ—à—É –¥–µ—Ä–∂–∞—Ç—å –≤–∞—Å –≤ —É–º–µ, —á—Ç–æ –º—ã –ø–∏—à–µ–º –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –∫–æ–¥, –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –º–æ–∂–Ω–æ –ø–æ–¥—á–µ—Ä–ø–Ω—É—Ç—å –∏–¥–µ–π –¥–ª—è —Ä–∞–∑–º—ã—à–ª–µ–Ω–∏—è, –Ω–æ –Ω–µ –¥–µ–ª–∞—Ç—å –≤—Å—ë –≤ —Ç–æ—á–Ω–æ—Å—Ç–∏ —Ç–∞–∫ –∂–µ.

</SideNote>

–í –º–∏—Ä–µ –û–û–ü –∏–¥–µ—è ¬´–ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏¬ª –Ω—É–∂–Ω—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤ –Ω—É–∂–Ω—ã–π –º–æ–º–µ–Ω—Ç ‚Äî —ç—Ç–æ –æ—Å–Ω–æ–≤–∞ [_–∏–Ω—ä–µ–∫—Ü–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π_](https://en.wikipedia.org/wiki/Dependency_injection). –í –æ–±—â–∏—Ö —á–µ—Ä—Ç–∞—Ö —Å–º—ã—Å–ª –≤ —Ç–æ–º, —á—Ç–æ–±—ã –∏–∑–±–∞–≤–∏—Ç—å –º–æ–¥—É–ª—å –æ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å _–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ_ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –æ–ø–æ—Ä–æ–π –Ω–∞ –∏—Ö _–æ–±–µ—â–∞–Ω–∏—è_ ‚Äî –ø—É–±–ª–∏—á–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã.

–¢–∞–∫ –º–æ–¥—É–ª–∏ _—Ä–∞—Å—Ü–µ–ø–ª—è—é—Ç—Å—è_ –¥—Ä—É–≥ –æ—Ç –¥—Ä—É–≥–∞, –ø–æ—Ç–æ–º—É –º–µ–∂–¥—É –Ω–∏–º–∏ –ø–æ—è–≤–ª—è–µ—Ç—Å—è ¬´–ø—Ä–æ—Å–ª–æ–π–∫–∞¬ª –∏–∑ [_DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞_](https://stackoverflow.com/questions/50718586/what-is-a-di-container) ‚Äî —à—Ç—É–∫–∏, –∫–æ—Ç–æ—Ä–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –Ω—É–∂–Ω—ã–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –º–µ—Å—Ç–∞, –≥–¥–µ –æ–±—ä—è–≤–ª–µ–Ω—ã –∏—Ö –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã. –í –û–û–ü-–∫–æ–¥–µ —ç—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É –∫–æ–º–ø–æ–Ω–æ–≤–∫–∏ –æ–±—ä–µ–∫—Ç–æ–≤ –∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –∏—Ö —Ä–∞–±–æ—Ç–æ–π —Å–∞–π–¥-—ç—Ñ—Ñ–µ–∫—Ç–æ–≤.

<SideNote>
  –í–æ–æ–±—â–µ, –∏–Ω—ä–µ–∫—Ü–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π ‚Äî —ç—Ç–æ —á–∞—Å—Ç–Ω—ã–π —Å–ª—É—á–∞–π _–∏–Ω–≤–µ—Ä—Å–∏–∏ –∫–æ–Ω—Ç—Ä–æ–ª—è_, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–≥–∞–µ—Ç –¥–µ–ª–∞—Ç—å
  –∫–æ–¥ –≥–∏–±—á–µ. –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ–± –∏–¥–µ–µ –∏–Ω–≤–µ—Ä—Å–∏–∏ –∫–æ–Ω—Ç—Ä–æ–ª—è, –∏–Ω—ä–µ–∫—Ü–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ —Ç–æ–º, –∫–∞–∫ —ç—Ç–æ –¥–µ–ª–∞—Ç—å –≤
  –û–û–ü-—Å—Ç–∏–ª–µ, —è [–ø–∏—Å–∞–ª –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ç–∞—Ç—å–µ](/blog/di-ts-in-practice/).
</SideNote>

–í –±–æ–ª–µ–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º –∫–æ–¥–µ –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ [–ø–µ—Ä–µ–¥–∞—é—Ç—Å—è _—è–≤–Ω–æ_](/blog/domain-modelling-made-functional-3/), –ø–æ—ç—Ç–æ–º—É DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –º—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ –±—É–¥–µ–º. –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º [—á–∞—Å—Ç–∏—á–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ](https://doka.guide/tools/fp/#chastichnoe-primenenie) —Ñ—É–Ω–∫—Ü–∏–π –∏ [—à–∞–±–ª–æ–Ω ¬´–§–∞–±—Ä–∏–∫–∞¬ª](https://www.patterns.dev/posts/factory-pattern), —á—Ç–æ ¬´–∑–∞–ø–µ—á—å¬ª –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.

<SideNote>
  –û–¥–Ω–∞–∫–æ, —ç—Ç–æ –Ω–µ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –≤ –æ–∫–æ–ª–æ-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º —Å—Ç–∏–ª–µ _–Ω–µ–ª—å–∑—è_ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å DI-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã ‚Äî —ç—Ç–æ
  —Å–∫–æ—Ä–µ–µ –≤–æ–ø—Ä–æ—Å –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤. –ù–æ —á—Ç–æ–±—ã –Ω–µ –¥–µ–ª–∞—Ç—å —Å–µ—Ä–∏—é —á—Ä–µ–∑–º–µ—Ä–Ω–æ —Å–ª–æ–∂–Ω–æ–π, –º—ã –Ω–µ –±—É–¥–µ–º
  –¥–æ–±–∞–≤–ª—è—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏.
</SideNote>

<SideNote>
–¢–∞–∫ –∂–µ —á–∏—Å—Ç–æ—Ç—ã —Ä–∞–¥–∏ —É–ø–æ–º—è–Ω–µ–º, —á—Ç–æ –≤ —á–∏—Å—Ç–æ-—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º –∫–æ–¥–µ [–ø–æ–Ω—è—Ç–∏—è ¬´–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π¬ª –≤ –ø—Ä–∏–Ω—Ü–∏–ø–µ –±—ã—Ç—å –Ω–µ –º–æ–∂–µ—Ç](https://blog.ploeh.dk/2017/02/02/dependency-rejection/), –ø–æ—Ç–æ–º—É —á—Ç–æ –ª—é–±–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –ø—Ä–∏–Ω–æ—Å–∏—Ç —Å —Å–æ–±–æ–π —Å–∞–π–¥-—ç—Ñ—Ñ–µ–∫—Ç, –∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –∫–æ–¥ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —á–∏—Å—Ç—ã–º. _–í—Å–µ_ —Å–∞–π–¥-—ç—Ñ—Ñ–µ–∫—Ç—ã (–∞ –∑–Ω–∞—á–∏—Ç –∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏) –≤ —Ç–∞–∫–æ–º –∫–æ–¥–µ –±—É–¥—É—Ç –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è –Ω–∞ _–∫—Ä–∞—è—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è_.

–ú—ã —Ç–∞–∫ –Ω–µ –¥–µ–ª–∞–µ–º –ª–∏—à—å –∏–∑ —Å–æ–æ–±—Ä–∞–∂–µ–Ω–∏–π —É–¥–æ–±—Å—Ç–≤–∞ –∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è. –ï—Å–ª–∏ –≤–∞–º –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ, –∫–∞–∫ —Å–∫–æ–º–ø–æ–Ω–æ–≤–∞—Ç—å React-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –≤ —á–∏—Å—Ç–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º —Å—Ç–∏–ª–µ, –¥–∞–π—Ç–µ –∑–Ω–∞—Ç—å.

</SideNote>

–í –æ–¥–Ω–æ–º –∏–∑ –ø—Ä–æ—à–ª—ã—Ö –ø–æ—Å—Ç–æ–≤ –º—ã –≤–æ—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å —Ñ–∞–∫—Ç–æ–º, —á—Ç–æ –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–∂–Ω–æ —Å—Å—ã–ª–∞—Ç—å—Å—è –Ω–∞ –µ—ë –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö, –æ–ø–∏—Ä–∞—è—Å—å –Ω–∞ –∏—Ö —Ç–∏–ø—ã:

```ts
// core/changeQuoteCode

// –û–±—ä—è–≤–ª—è–µ–º —Ç–∏–ø—ã –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π,
// –∫–æ—Ç–æ—Ä—ã–µ –ø–æ—Ç—Ä–µ–±—É—é—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏–∏:
type Dependencies = { saveConverter: SaveConverter };

// –ü–æ–ª—É—á–∞–µ–º –∫ –Ω–∏–º –¥–æ—Å—Ç—É–ø –∏–∑ –∞—Ä–≥—É–º–µ–Ω—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–∏ `deps`:
export const changeQuoteCode = (quoteCode, deps: Dependencies) => {
  // –ò—Å–ø–æ–ª—å–∑—É–µ–º –∏—Ö –≤–Ω—É—Ç—Ä–∏ —Ñ—É–Ω–∫—Ü–∏–∏,
  // –∑–Ω–∞—è, —á—Ç–æ –æ–Ω–∏ —Ä–µ–∞–ª–∏–∑—É—é—Ç –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–∏–ø:
  saveConverter({ quoteCode });
};
```

–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ —Ç–∞–∫–æ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ –ø–µ—Ä–µ–¥–∞–≤–∞–ª–∏—Å—å –ø–æ—Å–ª–µ–¥–Ω–∏–º –∞—Ä–≥—É–º–µ–Ω—Ç–æ–º:

```ts
const result = changeQuoteCode(realArgument, dependencies);
```

–ù–æ —Ç–∞–∫–∞—è –ø–µ—Ä–µ–¥–∞—á–∞ –≤—ã–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ: –Ω–∞–º –ª–∏–±–æ –Ω–∞–¥–æ –≤—Å–µ–≥–¥–∞ _—Ç—Ä–µ–±–æ–≤–∞—Ç—å_ –ø–µ—Ä–µ–¥–∞—Ç—å –∞—Ä–≥—É–º–µ–Ω—Ç —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏, –ª–∏–±–æ –¥–µ–ª–∞—Ç—å –µ–≥–æ _–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º_. –ù–∏ —Ç–æ, –Ω–∏ —Ç–æ –Ω–µ —É–¥–æ–±–Ω–æ –∏ [–Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –Ω–∞–¥—ë–∂–Ω–æ](https://en.wikipedia.org/wiki/Type_safety).

–†–µ—à–∏—Ç—å —ç—Ç–æ –ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–µ –º–æ–∂–Ω–æ, –∑–∞—Å—Ç–∞–≤–∏–≤ —Ñ—É–Ω–∫—Ü–∏—é ¬´–∑–∞–ø–æ–º–∏–Ω–∞—Ç—å¬ª —Å—Å—ã–ª–∫–∏ –Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```ts
const result = changeQuoteCode(realArgument); // + Remembered Dependencies
```

–ù–∞ –¥–µ–ª–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –ø–æ–ª–æ–∂–∏—Ç—å –≤ _–∑–∞–º—ã–∫–∞–Ω–∏–µ_ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–Ω–∞—Ä—É–∂–∏:

```ts
const createChangeQuoteCode = (dependencies) => {
  // Return another function that has access to `dependencies`
  // because it's in the parent scope which is visible to it.
  return (realArgument) => {
    // Do the stuff with `realArgument` AND `dependencies`.
  };
};
```

–ê –∑–∞—Ç–µ–º _—á–∞—Å—Ç–∏—á–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å_ —Ñ—É–Ω–∫—Ü–∏—é `createChangeQuoteCode`, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é —Å ¬´–∑–∞–ø–æ–º–Ω–µ–Ω–Ω—ã–º–∏¬ª –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏:

```ts
// Returns a function with ‚Äúremembered‚Äù dependencies:
const changeQuoteCode = createChangeQuoteCode(dependencies);

// Return the result of calling that function:
const result = changeQuoteCode(realArgument);
```

<SideNote>
  –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è —á–∞—Å—Ç–∏—á–Ω—ã–º, –ø–æ—Ç–æ–º—É —á—Ç–æ –º—ã —Ñ—É–Ω–∫—Ü–∏—é –≤–∏–¥–∞ `a -> b -> result` –≤—ã–ø–æ–ª–Ω—è–µ–º
  ¬´–Ω–∞–ø–æ–ª–æ–≤–∏–Ω—É¬ª, –∫–∞–∫ –±—ã –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—è—Å—å –ø–æ –ø—É—Ç–∏ –∏ –ø–æ–ª—É—á–∞—è –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ `b -> result`. –ß—É—Ç—å –ø–æ–¥—Ä–æ–±–Ω–µ–µ
  –æ–± —ç—Ç–æ–º –Ω–∞–ø–∏—Å–∞–Ω–æ –Ω–∞
  [learnyouhaskell](http://learnyouahaskell.com/higher-order-functions#curried-functions) –∏ —É
  [–°–∫–æ—Ç—Ç–∞ –í–ª–∞—à–∏–Ω–∞](https://fsharpforfunandprofit.com/posts/dependencies/).
</SideNote>

–¢–∞–∫—É—é —Ç–µ—Ö–Ω–∏–∫—É —Ä–∞–±–æ—Ç—ã —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –∏–Ω–æ–≥–¥–∞ –Ω–∞–∑—ã–≤–∞—é—Ç ¬´–∑–∞–ø–µ–∫–∞–Ω–∏–µ–º¬ª (‚Äúbaking‚Äù dependencies). –ò–º–µ–Ω–Ω–æ –µ—ë –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º, —á—Ç–æ–±—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –∞–¥–∞–ø—Ç–µ—Ä –∫ API.

### ¬´–ó–∞–ø–µ–∫–∞–µ–º¬ª –∞–¥–∞–ø—Ç–µ—Ä

–ß—Ç–æ–±—ã –∑–∞–ø–µ—á—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, —Å–æ–∑–¥–∞–¥–∏–º —Ñ—É–Ω–∫—Ü–∏—é-—Ñ–∞–±—Ä–∏–∫—É, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∞–¥–∞–ø—Ç–µ—Ä–∞ –∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å `FetchRates`:

```ts
import type { FetchRates } from "../../core/ports.output";
import type { ServerRates } from "./api.serialization";

type Dependencies = { request: ApiRequest<ServerRates> };
type CreateFetchRates = (dependencies: Dependencies) => FetchRates;
```

–í –∫–æ–¥–µ –º—ã –º–æ–∂–µ–º —ç—Ç–æ –≤—ã—Ä–∞–∑–∏—Ç—å —Ç–∞–∫:

```ts
// infrastructure/api

import { toDomain } from "./api.serialization";

// –†–µ–∞–ª–∏–∑—É–µ–º ¬´—Ñ–∞–±—Ä–∏–∫—É¬ª, –∫–æ—Ç–æ—Ä–∞—è –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏,
// –∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç ¬´–Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—É—é¬ª —Ñ—É–Ω–∫—Ü–∏—é-–∞–¥–∞–ø—Ç–µ—Ä:

const createFetchRates: CreateFetchRates =
  ({ request }) =>
  async () => {
    const response = await request("/rates");
    const data = toDomain(response);
    return data;
  };
```

–¢–æ–≥–¥–∞, –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∞–¥–∞–ø—Ç–µ—Ä–∞ –∏ –µ–≥–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –º—ã –≤—ã–∑–æ–≤–µ–º —Ñ–∞–±—Ä–∏–∫—É –∏ –ø–µ—Ä–µ–¥–∞–¥–∏–º —Ç—É–¥–∞ –æ–±—ä–µ–∫—Ç —Å –Ω–∞—Å—Ç–æ—è—â–∏–º —Å–µ—Ä–≤–∏—Å–æ–º:

```ts
// infrastructure/api.composition

import type { FetchRates } from "../../core/ports.output";
import { get } from "~/services/network";

export const fetchRates: FetchRates = createFetchRates({ request: get });
```

–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ —Ä–∞–±–æ—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—É—é –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `createFetchRates`, –∑–∞–≤–∏—Å–∏—Ç —Ç–æ–ª—å–∫–æ –æ—Ç —Ç–∏–ø–æ–≤ —Å–µ—Ä–≤–∏—Å–æ–≤. –ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫—É –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π —Å–µ—Ä–≤–∏—Å–æ–≤ –º—ã –ø—Ä–æ–≤–æ–¥–∏–º –æ—Ç–¥–µ–ª—å–Ω–æ ‚Äî –≤–æ –≤—Ä–µ–º—è –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏. –ù–∞–º–µ—Ä–µ–Ω–∏–µ (—Ä–∞–±–æ—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–∏) –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (–∫–æ–º–ø–æ–∑–∏—Ü–∏—è) —Å–Ω–æ–≤–∞ –æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ä–∞–∑–¥–µ–ª–µ–Ω—ã, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –º–æ–¥—É–ª–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º–µ–µ.

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –∏ –∫–æ–º–ø–æ–∑–∏—Ü–∏—è

–ü–æ—Å–º–æ—Ç—Ä–∏–º –ø–æ–≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω–µ–µ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∏ –∫–æ–º–ø–æ–∑–∏—Ü–∏—é –º–æ–¥—É–ª—è. –ú—ã –º–æ–∂–µ–º –∑–∞–º–µ—Ç–∏—Ç—å, —á—Ç–æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∞–±—Ä–∏–∫–∏ –∏ –µ—ë —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ ‚Äî —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä–∞—è —Ä–µ–∞–ª–∏–∑—É–µ—Ç –≤—Ö–æ–¥–Ω–æ–π –ø–æ—Ä—Ç, ‚Äî –∑–∞–≤–∏—Å–∏—Ç —Ç–æ–ª—å–∫–æ –æ—Ç –¥–≤—É—Ö –≤–µ—â–µ–π:

- –≤–Ω—É—Ç—Ä–µ–Ω–Ω–æ—Å—Ç–µ–π _—ç—Ç–æ–≥–æ –∂–µ_ –º–æ–¥—É–ª—è;
- _—Ç–∏–ø–æ–≤_ –≤—Å–µ–≥–æ –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ.

```ts
// infrastructure/api

// –ï—Å–ª–∏ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º —á—Ç–æ-—Ç–æ —Å–Ω–∞—Ä—É–∂–∏ –º–æ–¥—É–ª—è,
// —Ç–æ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ —Ç–∏–ø—ã:
import type { ApiRequest } from "~/shared/kernel";
import type { FetchRates } from "../../core/ports.output";

// –ò–∑ —Å–∞–º–æ–≥–æ –º–æ–¥—É–ª—è –º—ã –º–æ–∂–µ–º –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —á—Ç–æ —É–≥–æ–¥–Ω–æ:
import type { RatesDTO } from "./api.serialization";
import { toDomain } from "./api.serialization";

export const createFetchRates =
  ({ request }: Dependencies): FetchRates =>
  async () => {
    // ...
  };
```

–¢–∞–∫–æ–µ ¬´–æ—Ç–≥–æ—Ä–∞–∂–∏–≤–∞–Ω–∏–µ¬ª –≤ –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª–µ–π —á–µ—Ä–µ–∑ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏—é –ø–æ–º–æ–≥–∞–µ—Ç –∏–∑–±–µ–∂–∞—Ç—å –ª–∏—à–Ω–µ–≥–æ –∑–∞—Ü–µ–ø–ª–µ–Ω–∏—è. –£ –º–æ–¥—É–ª—è –ø–æ—è–≤–ª—è–µ—Ç—Å—è _–æ–¥–Ω–∞_ –ø–æ–Ω—è—Ç–Ω–∞—è –≤—Ö–æ–¥–Ω–∞—è —Ç–æ—á–∫–∞ –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö –º–æ–¥—É–ª–µ–π ‚Äî _–ø—É–±–ª–∏—á–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å_:

![–°–≤—è–∑—å –∏ –æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Å–Ω–∏–∂–∞–µ—Ç—Å—è –∑–∞—Ü–µ–ø–ª–µ–Ω–∏–µ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ –∏—Ö –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –¥–µ—Ç–∞–ª–∏ —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –Ω–µ –≤–∞–∂–Ω—ã –ø—Ä–∏ –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](/images/content/explicit-design-series/04-low-coupling.png)

–¢–∞–∫–∞—è —Ç–æ—á–∫–∞ –≤—Ö–æ–¥–∞ —Å–Ω–∏–∂–∞–µ—Ç –∑–∞—Ü–µ–ø–ª–µ–Ω–∏–µ –∏ –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ –∫–æ–¥–æ–≤–æ–π –±–∞–∑–µ, –ø–æ—Ç–æ–º—É —á—Ç–æ –¥—Ä—É–≥–∏–º –º–æ–¥—É–ª—è–º —Å—Ç–∞–Ω–æ–≤—è—Ç—Å—è –Ω–µ –≤–∞–∂–Ω—ã –≤–Ω—É—Ç—Ä–µ–Ω–Ω–æ—Å—Ç–∏ —ç—Ç–æ–≥–æ –º–æ–¥—É–ª—è –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç.

–ü–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–π –∂–µ ‚Äî —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –∑–∞—Ü–µ–ø–ª–µ–Ω–∏—è ‚Äî –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–µ–º —ç—Ç–∞–ø–µ, –ø—Ä–∏ –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ –º–æ–¥—É–ª—è:

```ts
// infrastructure/api.composition

import { createFetchRates } from "./api";
import { get as request } from "~/services/network";

export const fetchRates: FetchRates = createFetchRates({ request: get });
```

–ù—É –∏ –≤ –∫–æ–Ω—Ü–µ, —á—Ç–æ–±—ã —Å–∫—Ä—ã—Ç—å —Ç–æ, —á—Ç–æ –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ —Å–Ω–∞—Ä—É–∂–∏, –º—ã –º–æ–∂–µ–º –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ-—ç–∫—Å–ø–æ—Ä—Ç—ã —á–µ—Ä–µ–∑ `index.ts`:

```ts
// api/index

export * from "./api.composition";
```

–¢–æ–≥–¥–∞ –∏–∑ –≤—Å–µ—Ö –¥–µ—Ç–∞–ª–µ–π –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–æ–¥—É–ª—è:

```
infrastructure/api/
  - api.ts                ‚Äî —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏ —Ñ–∞–±—Ä–∏–∫–∞ —Ñ—É–Ω–∫—Ü–∏–∏;
  - api.serialization.ts  ‚Äî —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö;
  - api.test.ts           ‚Äî —Ç–µ—Å—Ç—ã –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏;
  - api.composition.ts    ‚Äî –∫–æ–º–ø–æ–∑–∏—Ü–∏—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω-–≤–µ—Ä—Å–∏–∏;
  - index.ts
```

...–°–Ω–∞—Ä—É–∂–∏ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ `api.composition.ts`.

<SideNote>
–ü–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –≤ JS –Ω–µ–ª—å–∑—è –ø–æ-–Ω–∞—Å—Ç–æ—è—â–µ–º—É –∑–∞–ø—Ä–µ—Ç–∏—Ç—å –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —á—Ç–æ-—Ç–æ –∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤. –ù–æ, –≤–æ-–ø–µ—Ä–≤—ã—Ö, —ç—Ç–æ –≤—ã—Ä–∞–∂–∞–µ—Ç –Ω–∞–º–µ—Ä–µ–Ω–∏–µ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É, –∞ –≤–æ-–≤—Ç–æ—Ä—ã—Ö, –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –º–æ–∂–Ω–æ –ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏ –∑–∞—ç–Ω—Ñ–æ—Ä—Å–∏—Ç—å —Å –ø–æ–º–æ—â—å—é –ª–∏–Ω—Ç–µ—Ä–∞ –∏–ª–∏ [–¥—Ä—É–≥–∏—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤](https://github.com/ts-arch/ts-arch).

–î—Ä—É–≥–æ–µ –¥–µ–ª–æ, —á—Ç–æ –æ–ø—è—Ç—å –∂–µ —Ç–∞–∫–æ–π –ø—É—Ä–∏–∑–º –ø—Ä–æ–µ–∫—Ç—É –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –Ω—É–∂–µ–Ω. –ü–æ–º–Ω–∏–º, —á—Ç–æ –∫–æ–¥ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π üôÉ

</SideNote>

## –°—Ç–æ—Ä –∫–∞–∫ —Å–µ—Ä–≤–∏—Å

–ö—Ä–æ–º–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä—É –µ—â—ë –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Å—Ç–æ—Ä ‚Äî —Ä–∞–Ω—Ç–∞–π–º-—Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–ª—è –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –∫–æ—Ç–∏—Ä–æ–≤–æ–∫ –∏ –∑–Ω–∞—á–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –≤–≤–µ–¥—É—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏. –°–µ–≥–æ–¥–Ω—è –º—ã –Ω–∞–ø–∏—à–µ–º —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å—Ç–æ—Ä–∞ —Å –ø–æ–º–æ—â—å—é [Context API](https://react.dev/learn/passing-data-deeply-with-context), –Ω–æ –≤ –±—É–¥—É—â–µ–º –º—ã –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –¥–ª—è —ç—Ç–æ–π –∑–∞–¥–∞—á–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.

### –ü–æ—Ä—Ç—ã –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

–ù–∞—á–Ω—ë–º —Å –æ–±–∑–æ—Ä–∞ —Ç—Ä–µ–±—É–µ–º–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏. –Ø–¥—Ä–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ç—Ä–µ–±—É–µ—Ç –æ—Ç —Å—Ç–æ—Ä–∞ 2 —Ñ—É–Ω–∫—Ü–∏–∏: –¥–ª—è —á—Ç–µ–Ω–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –º–æ–¥–µ–ª–∏.

```ts
// core/ports.output.ts

type ReadConverter = () => Converter;
type SaveConverter = (patch: Partial<Converter>) => void;
```

–î–ª—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –º—ã –º–æ–∂–µ–º —Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å —Ç–∞–∫–∏–º —Ç–∏–ø–æ–º:

```ts
// infrastructure/store

// –¢–∏–ø, –æ–ø–∏—Å—ã–≤–∞—é—â–∏–π —Ö—Ä–∞–Ω–∏–ª–∏—â–µ, –ø—Ä–∏–≤–∞—Ç–Ω—ã–π.
// –≠—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç —Å–æ—Å–µ–¥–Ω–∏–º –º–æ–¥—É–ª—è–º –Ω–µ –∑–∞–≤–∏—Å–µ—Ç—å
// –æ—Ç –¥–µ—Ç–∞–ª–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å—Ç–æ—Ä–∞.
type Store = {
  value: Converter;
  update: SaveConverter;

  // –ö–∞–∫ –≤–∞—Ä–∏–∞–Ω—Ç, –º–æ–∂–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ
  // –ø—Ä—è–º —è–≤–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —á—Ç–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö,
  // –Ω–æ –≤ —Å–ª—É—á–∞–µ —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º —ç—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.
  read: ReadConverter;
};

const ConverterContext = createContext<Nullable<Store>>(null);
export const useStore = () => useContext(ConverterContext);
```

–î–∞–ª–µ–µ —Å–æ–∑–¥–∞–¥–∏–º –ø—Ä–æ–≤–∞–π–¥–µ—Ä:

```tsx
// infrastructure/store

export const StoreProvider = ({ children }: PropsWithChildren) => {
  const [value, setValue] = useState<Converter>(initialModel);

  // –ï—Å–ª–∏ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ç–¥–µ–ª—å–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é –¥–ª—è —á—Ç–µ–Ω–∏—è
  // (—ç—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):
  const read = () => value;

  const update: StoreWriter = (patch) => setValue((state) => ({ ...state, ...patch }));

  return (
    <ConverterContext.Provider value={{ value, read, update }}>
      {children}
    </ConverterContext.Provider>
  );
};
```

<SideNote>
  –¢–∞–∫–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –±—É–¥–µ—Ç [–ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ –ª–∏—à–Ω–∏–º
  –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∫–∞–º](https://alexsidorenko.com/blog/react-render-context/) –∑–∞–≤–∏—Å—è—â–∏—Ö –æ—Ç –Ω–µ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.
  –í —Ä–µ–∞–ª—å–Ω—ã—Ö –ø—Ä–æ–µ–∫—Ç–∞—Ö —Å—Ç–∞—Ä–∞–π—Ç–µ—Å—å –∏–∑–±–µ–≥–∞—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ –∫–∞—á–µ—Å—Ç–≤–µ —Å—Ç–µ–π—Ç-–º–µ–Ω–µ–¥–∂–µ—Ä–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–ª—è
  —ç—Ç–æ–≥–æ –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏.
</SideNote>

### –ö–æ–º–ø–æ–∑–∏—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞

–ù–∞–º –æ—Å—Ç–∞–ª–æ—Å—å –∞—Å—Å–æ—Ü–∏–∏—Ä–æ–≤–∞—Ç—å —Ç–∏–ø—ã –ø–æ—Ä—Ç–æ–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π ‚Äî ¬´–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å¬ª —Å–µ—Ä–≤–∏—Å:

```ts
// infrastructure/store.composition

import type { ReadConverter, SaveConverter } from "../../core/ports.output";
import { StoreProvider, useStore } from "./store";

export const useStoreWriter: Provider<SaveConverter> = () => useStore().update;
export const useConverter: ReadConverter = () => useStore().value;

// –ò–ª–∏ –µ—Å–ª–∏ –Ω–∞–º –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è —á—Ç–µ–Ω–∏—è:
export const useStoreReader: Provider<ReadConverter> = () => useStore().read;
```

–ó–∞–º–µ—Ç–∏–º, —á—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –æ —Ç–æ–º, –∫–∞–∫—É—é –∏–º–µ–Ω–Ω–æ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—é –ø—Ä–∏–º–µ–Ω—è—Ç—å –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞, –º—ã –ø—Ä–∏–Ω—è–ª–∏ —É–∂–µ –≤ —Å–∞–º–æ–º –∫–æ–Ω—Ü–µ ‚Äî –∫–æ–≥–¥–∞ —è–¥—Ä–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —É–∂–µ –±—ã–ª–æ –≥–æ—Ç–æ–≤–æ. –≠—Ç–æ —Ö–æ—Ä–æ—à–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ –Ω–∞–∫–ª–∞–¥—ã–≤–∞–µ—Ç –Ω–∞ –Ω–∞—Å –º–µ–Ω—å—à–µ –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –≤ –≤—ã–±–æ—Ä–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤. –ù–∞–æ–±–æ—Ä–æ—Ç, –∫–æ–≥–¥–∞ –º—ã –ø—Ä–∏–Ω–∏–º–∞–µ–º —Ä–µ—à–µ–Ω–∏–µ –æ —Ç—É–ª–∏–Ω–≥–µ, –º—ã —É–∂–µ –∑–Ω–∞–µ–º –æ –ø—Ä–æ–µ–∫—Ç–µ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ –±–æ–ª—å—à–µ –∏ –º–æ–∂–µ–º –ø–æ–¥–æ–±—Ä–∞—Ç—å –±–æ–ª–µ–µ –∞–¥–µ–∫–≤–∞—Ç–Ω—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É –ø–æ–¥ –Ω–∞—à–∏ –∑–∞–¥–∞—á–∏.

<SideNote>
  –í –æ–¥–Ω–æ–º –∏–∑ —Å–ª–µ–¥—É—é—â–∏—Ö –ø–æ—Å—Ç–æ–≤ –º—ã –∫–∞–∫ —Ä–∞–∑ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ —Ç–æ, –∫–∞–∫ –≤—ã–±–∏—Ä–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã, –µ—Å–ª–∏ —É –ø—Ä–æ–µ–∫—Ç–∞
  –µ—Å—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –∑–∞ –≤—Ä–µ–º—è –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, –∏ –∫–∞–∫ –Ω–∞–º –ø–æ–º–æ–∂–µ—Ç —Å–ª–∞–±–æ–µ –∑–∞—Ü–µ–ø–ª–µ–Ω–∏–µ –º–æ–¥—É–ª–µ–π.
</SideNote>

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –º–∏–º–æ —è–¥—Ä–∞

–ö—Ä–æ–º–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–µ—Ä–∞ —á–µ—Ä–µ–∑ `SaveConverter`, –Ω–∞–º –≤ UI —Ç–∞–∫–∂–µ –Ω—É–∂–Ω–æ —á–∏—Ç–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏–∑ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞:

```ts
// shared/kernel.ts
type Selector<T> = () => T;

// core/ports.input.ts
type SelectBaseValue = Selector<BaseValue>;
type SelectQuoteValue = Selector<QuoteValue>;
type SelectQuoteCode = Selector<QuoteCurrencyCode>;
```

–¢–∞–∫ –∫–∞–∫ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö —è–¥—Ä–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∏–∫–∞–∫ –Ω–µ –∑–∞–¥–µ–π—Å—Ç–≤–æ–≤–∞–Ω–æ (–ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ –º—ã –Ω–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –¥–æ–º–µ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏), –º—ã –º–æ–∂–µ–º —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –ø–æ—Ä—Ç—ã –¥–ª—è —á—Ç–µ–Ω–∏—è –ø—Ä—è–º–æ –≤ —Å–µ—Ä–≤–∏—Å–µ —Å—Ç–æ—Ä–∞:

```ts
// infrastructure/store.composition

import type { SelectBaseValue, SelectQuoteCode, SelectQuoteValue } from "../../core/ports.input";

const useValueBase: SelectBaseValue = () => useStore().value.baseValue;
const useQuoteCode: SelectQuoteCode = () => useStore().value.quoteCode;
const useValueQuote: SelectQuoteValue = () => useStore().value.quoteValue;
```

–¢–∞–∫–æ–π ¬´—Ñ–∞—Å—Ç-—Ç—Ä–µ–∫¬ª –º–∏–º–æ —è–¥—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî —á–∞—Å—Ç–∞—è –∏—Å—Ç–æ—Ä–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö, –≥–¥–µ –º–∞–ª–æ –∏–ª–∏ –≤–æ–≤—Å–µ [–Ω–µ—Ç –¥–æ–º–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏](https://ru.wikipedia.org/wiki/CRUD).

![–¢–µ –ø—Ä–æ—Ü–µ—Å—Å—ã, –≤ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–µ—Ç –¥–æ–º–µ–Ω–Ω–æ–π –ª–æ–≥–∏–∫–∏ –∏ –ø—Ä–µ–æ–±–∞—Ä–∑–æ–≤–∞–Ω–∏–π –¥–∞–Ω–Ω—ã—Ö, –º–æ–∂–Ω–æ ¬´–∑–∞–∫–æ—Ä–æ—Ç–∏—Ç—å¬ª –∏ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –º–∏–º–æ —è–¥—Ä–∞](/images/content/explicit-design-series/04-short-circuit.png)

–Ø –Ω–µ –≤–∏–∂—É –≤ —Ç–∞–∫–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∏—á–µ–≥–æ —Å—Ç—Ä–∞—à–Ω–æ–≥–æ, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–µ—Ä–≤–∏—Å –≤—Å—ë –µ—â—ë —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å –æ—Å—Ç–∞–ª—å–Ω–æ–π —á–∞—Å—Ç—å—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏, –ø–æ—ç—Ç–æ–º—É –∑–∞—Ü–µ–ø–ª–µ–Ω–∏–µ –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏ –ø–æ—á—Ç–∏ –Ω–µ —Ä–∞—Å—Ç—ë—Ç.

## –ü–æ—á—Ç–∏ –≤—Å—ë –≤–º–µ—Å—Ç–µ

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ—á—Ç–∏ –≥–æ—Ç–æ–≤–æ. –ú—ã —Å–æ–∑–¥–∞–ª–∏ –º–æ–¥–µ–ª—å –∏ –ø—Ä–æ—Ä–∞–±–æ—Ç–∞–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏, —Å–æ–∑–¥–∞–ª–∏ UI-—Å–ª–æ–π –∏ –Ω—É–∂–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –æ–ø–∏—Å–∞–ª–∏ —Å–µ—Ä–≤–∏—Å—ã –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API –∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö. –¢–µ–ø–µ—Ä—å –Ω–∞–º –æ—Å—Ç–∞–ª–æ—Å—å —Å–æ–±—Ä–∞—Ç—å —ç—Ç–æ –≤—Å—ë –≤–º–µ—Å—Ç–µ —Å —Ä–∞–±–æ—á–∏–π –ø—Ä–æ–µ–∫—Ç, —á–µ–º –º—ã –∏ –∑–∞–π–º—ë–º—Å—è –≤ —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑.

## –í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑

–°–µ–≥–æ–¥–Ω—è –º—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ –≤—Å—é –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ø—Ä–∏–≤—è–∑–∞–ª–∏ –µ—ë –∫ –≤—ã—Ö–æ–¥–Ω—ã–º –ø–æ—Ä—Ç–∞–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. [–í —Å–ª–µ–¥—É—é—â–µ–º –ø–æ—Å—Ç–µ](/blog/explicit-design-5) –º—ã —Å–æ–±–µ—Ä—ë–º —Ü–µ–ª–∏–∫–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏–∑ –µ–≥–æ —á–∞—Å—Ç–µ–π, –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ö—É–∫–∏ –∫–∞–∫ —Å–ø–æ—Å–æ–± –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏, –∞ —Ç–∞–∫–∂–µ –ø–æ–¥—É–º–∞–µ–º, –∫–∞–∫–∏–µ –µ—â—ë —Å–ø–æ—Å–æ–±—ã –º–æ–≥—É—Ç –±—ã—Ç—å.

## –°—Å—ã–ª–∫–∏

–í—Å–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ –∫–Ω–∏–≥–∏, —Å—Ç–∞—Ç—å–∏ –∏ –¥—Ä—É–≥–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã, —É–ø–æ–º—è–Ω—É—Ç—ã–µ –≤ —Å—Ç–∞—Ç—å–µ.

- [–ò—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥ —ç—Ç–∞–ø–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞ –ì–∏—Ç—Ö–∞–±–µ](https://github.com/bespoyasov/explicit-design/tree/main/04-ports-and-adapters-infrastructure)
- [–ë–ª–æ–≥ –Ω–∞ –ì–∏—Ç—Ö–∞–±–µ –Ω–∞ —Å–ª—É—á–∞–π –æ–ø–µ—á–∞—Ç–æ–∫](https://github.com/bespoyasov/www)

### –ü–∞—Ç—Ç–µ—Ä–Ω—ã –∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã

- [Factory Pattern](https://www.patterns.dev/posts/factory-pattern)
- [–ò–Ω–≤–µ—Ä—Å–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è, –í–∏–∫–∏–ø–µ–¥–∏—è](https://ru.wikipedia.org/wiki/–ò–Ω–≤–µ—Ä—Å–∏—è_—É–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
- [–û–±—ä–µ–∫—Ç –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö, –í–∏–∫–∏–ø–µ–¥–∏—è](https://ru.wikipedia.org/wiki/DTO)
- [–°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è, –í–∏–∫–∏–ø–µ–¥–∏—è](https://ru.wikipedia.org/wiki/–°–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è)

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ

- [Curried functions](http://learnyouahaskell.com/higher-order-functions#curried-functions)
- [Dependency rejection](https://blog.ploeh.dk/2017/02/02/dependency-rejection/)
- [Domain Modelling Made Functional. Scott Wlaschin](/blog/domain-modelling-made-functional/)
- [–ß–∞—Å—Ç–∏—á–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π](https://doka.guide/tools/fp/#chastichnoe-primenenie)

### –†–∞–±–æ—Ç–∞ —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

- [Reflecting architecture and domain in code](https://herbertograca.com/2019/06/05/reflecting-architecture-and-domain-in-code/)
- [Six approaches to dependency injection](https://fsharpforfunandprofit.com/posts/dependencies/)
- [What is a DI Container?](https://stackoverflow.com/questions/50718586/what-is-a-di-container)
- [–í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Å TypeScript –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ](https://bespoyasov.ru/blog/di-ts-in-practice/)
- [–í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –í–∏–∫–∏–ø–µ–¥–∏—è](https://ru.wikipedia.org/wiki/–í–Ω–µ–¥—Ä–µ–Ω–∏–µ_–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)
- [–°–≤—è–∑–Ω–æ—Å—Ç—å (–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ), –í–∏–∫–∏–ø–µ–¥–∏—è](<https://ru.wikipedia.org/wiki/–°–≤—è–∑–Ω–æ—Å—Ç—å_(–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ)>)

### –ö–æ–Ω—Ç–µ–∫—Å—Ç –∏ —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ –≤ –†–µ–∞–∫—Ç–µ

- [Passing Data Deeply with Context](https://react.dev/learn/passing-data-deeply-with-context)
- [Visual Guide to React Rendering](https://alexsidorenko.com/blog/react-render-context/)

### –ü—Ä–æ—á–µ–µ

- [Architecture unit test framework for Typescript](https://github.com/ts-arch/ts-arch)
- [Generics in TypeScript](https://www.typescriptlang.org/docs/handbook/2/generics.html)
- [–ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è, MDN](https://developer.mozilla.org/ru/docs/Glossary/Abstraction)
- [–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –í–∏–∫–∏–ø–µ–¥–∏—è](https://ru.wikipedia.org/wiki/–¢–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
- [CRUD, –í–∏–∫–∏–ø–µ–¥–∏—è](https://ru.wikipedia.org/wiki/CRUD)

### –î—Ä—É–≥–∏–µ —á–∞—Å—Ç–∏ —Å–µ—Ä–∏–∏

- [–í–≤–µ–¥–µ–Ω–∏–µ, –ø—Ä–µ–¥–ø–æ—Å—ã–ª–∫–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è](/blog/explicit-design-series)
- [–ú–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏](/blog/explicit-design-1)
- [–ü—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤](/blog/explicit-design-2)
- [–û–ø–∏—Å–∞–Ω–∏–µ UI –∫–∞–∫ ¬´–∞–¥–∞–ø—Ç–µ—Ä–∞¬ª –∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é](/blog/explicit-design-3)
- –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–æ–¥ –Ω—É–∂–¥—ã —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ (—ç—Ç–æ—Ç –ø–æ—Å—Ç)
- [–ö–æ–º–ø–æ–∑–∏—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ —Ö—É–∫–∞—Ö](/blog/explicit-design-5)
- –ö–æ–º–ø–æ–∑–∏—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –±–µ–∑ —Ö—É–∫–æ–≤
- –í–Ω–µ–¥—Ä–µ–Ω–∏–µ cross-cutting concerns
- –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –Ω–æ–≤–æ–π —Ñ–∏—á–µ–π
- –†–∞—Å—Ü–µ–ø–ª–µ–Ω–∏–µ —Ñ–∏—á –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- –û–±–∑–æ—Ä –∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –≤—ã–≤–æ–¥—ã
